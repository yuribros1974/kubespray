FROM centos:7.6.1810

RUN mkdir /kubespray
WORKDIR /kubespray
RUN yum install -y epel-release \
    && yum install -y openssl-devel openssh-clients python-devel sshpass gcc ca-certificates curl gnupg2 python2-pip python36 python36-pip \
    && yum clean all \
    && rm -rf /var/cache/yum \
    && pip install --no-cache-dir --upgrade pip==20.1.1

COPY . .
RUN /usr/bin/pip install -r igz_requirements.txt
RUN /usr/bin/pip3 install -r contrib/inventory_builder/requirements.txt

ENTRYPOINT ["/kubespray/run.py"]
